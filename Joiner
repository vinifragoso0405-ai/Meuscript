-- [[ KALIUX FINDER - SISTEMA DIN√ÇMICO ]] --
local HttpService = game:GetService("HttpService")
local TeleportService = game:GetService("TeleportService")
local CoreGui = game:GetService("CoreGui")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer

-- URL do Firebase (Sync com Notifier)
local FIREBASE_URL = "https://meu-joiner-default-rtdb.firebaseio.com/.json"
local currentJobId = ""

-- Limpeza de interface anterior
for _, v in pairs(CoreGui:GetChildren()) do
    if v.Name == "KALIUX_Finder_Final" then v:Destroy() end
end

-- Interface Principal
local MainGui = Instance.new("ScreenGui", CoreGui)
MainGui.Name = "KALIUX_Finder_Final"

local MainFrame = Instance.new("Frame", MainGui)
MainFrame.Size = UDim2.new(0, 300, 0, 380)
MainFrame.Position = UDim2.new(0.5, -150, 0.5, -190)
MainFrame.BackgroundColor3 = Color3.fromRGB(15, 15, 15)
MainFrame.Visible = true
MainFrame.Draggable = true
MainFrame.Active = true
Instance.new("UICorner", MainFrame).CornerRadius = UDim.new(0, 15)
Instance.new("UIStroke", MainFrame).Color = Color3.fromRGB(200, 0, 0)

-- Header
local Header = Instance.new("TextLabel", MainFrame)
Header.Size = UDim2.new(1, 0, 0, 50)
Header.Text = "KALIUX FINDER"
Header.TextColor3 = Color3.fromRGB(255, 0, 0)
Header.Font = Enum.Font.GothamBold
Header.TextSize = 18
Header.BackgroundTransparency = 1

-- Espa√ßo de Lista (Onde os dados aparecer√£o)
local ServerList = Instance.new("ScrollingFrame", MainFrame)
ServerList.Name = "FinderArea"
ServerList.Size = UDim2.new(1, -20, 0, 280)
ServerList.Position = UDim2.new(0, 10, 0, 90)
ServerList.BackgroundTransparency = 1
ServerList.ScrollBarThickness = 2
ServerList.CanvasSize = UDim2.new(0, 0, 0, 0)

local Layout = Instance.new("UIListLayout", ServerList)
Layout.Padding = UDim.new(0, 10)
Layout.HorizontalAlignment = Enum.HorizontalAlignment.Center

-- Fun√ß√£o para criar o Card do Servidor na UI
local function CreateServerCard(name, value, jobId, placeId)
    -- Limpa lista anterior para mostrar apenas o mais recente
    for _, v in pairs(ServerList:GetChildren()) do
        if v:IsA("Frame") then v:Destroy() end
    end

    local Card = Instance.new("Frame", ServerList)
    Card.Size = UDim2.new(1, 0, 0, 80)
    Card.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
    Instance.new("UICorner", Card)

    local Info = Instance.new("TextLabel", Card)
    Info.Size = UDim2.new(1, -10, 0, 40)
    Info.Position = UDim2.new(0, 10, 0, 5)
    -- Mostra o Nome e o Valor extra√≠do do Brainrot
    Info.Text = "üìç " .. name .. "\nüí∞ Valor: " .. value
    Info.TextColor3 = Color3.new(1, 1, 1)
    Info.TextXAlignment = Enum.TextXAlignment.Left
    Info.BackgroundTransparency = 1
    Info.Font = Enum.Font.GothamMedium
    Info.TextSize = 14

    local JoinBtn = Instance.new("TextButton", Card)
    JoinBtn.Size = UDim2.new(0.9, 0, 0, 30)
    JoinBtn.Position = UDim2.new(0.05, 0, 0, 45)
    JoinBtn.Text = "JOIN"
    JoinBtn.BackgroundColor3 = Color3.fromRGB(200, 0, 0)
    JoinBtn.TextColor3 = Color3.new(1, 1, 1)
    JoinBtn.Font = Enum.Font.GothamBold
    Instance.new("UICorner", JoinBtn)

    -- Teleporte funcional pelo JobId (InstanceId)
    JoinBtn.MouseButton1Click:Connect(function()
        local cleanID = tostring(jobId):gsub("%s+", ""):gsub("\"", "")
        TeleportService:TeleportToPlaceInstance(tonumber(placeId or 18260270114), cleanID, Player)
    end)
end

-- Monitoramento HTTPS em tempo real
task.spawn(function()
    while task.wait(2) do
        local s, r = pcall(function() return game:HttpGet(FIREBASE_URL) end)
        if s and r then
            local data = HttpService:JSONDecode(r)
            -- Se chegar algo novo na Firebase, atualiza a √°rea Finder
            if data and data.jobId and data.jobId ~= currentJobId then
                currentJobId = data.jobId
                local name = data.serverName or "Brainrot Server"
                local val = data.value or "$0.0M/s"
                
                -- Cria o bot√£o e as infos no espa√ßo livre
                CreateServerCard(name, val, data.jobId, data.placeId)
            end
        end
    end
end)
